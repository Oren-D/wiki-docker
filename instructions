בשביל שהקובץ יהיה יותר קריא יש לפתוח בפנקס או בוורד !




פרויקט מסכם בקורס כלי פיתוח: הקמת WIKI של מושגי הקורס - סמסטר א תשפד מרצה: איל איזנשטיין
התארגנות בצוותים
את הפרויקט המסכם יש לבצע בצוותים.
לכל צוות יש ראש צוות ותפקידה הוא להגיש את תוצרי הפרויקט באמצעות תיבת ההגשה שתפתח לכם.
על ראשי הצוותים בלבד לפרסם בפורום לבחירת צוותים – עד יום ראשון, 25 בפברואר בשעה 21:00 את
פרטי חברי הצוות:
● ראש הצוות תפרסם הודעה בפורום עם שמות חברי הצוות ומספרי הזהות שלכם.
● סטודנטיות וסטודנטים שמחפשים צוות להצטרף אליו, יכולים לפרסם הודעה לחיפוש צוות בפורום.
התקנות בסיסיות של הפרויקט באמצעות DOCKER
על כל סטודנטית וסטודנט בצוות להקים פרויקט WIKI MEDIA בסביבת LINUX, שהנתונים שלו נשמרים
בבסיס נתונים של MYSQL באמצעות DOCKER.
.1 עליכם להתקין באמצעות DOCKER בסיס נתונים של MYSQL.
א. יש להעזר בהוראות ההקמה של בסיס הנתונים בדף הרשמי של בסיס הנתונים ב-HUB DOCKER:
https://hub.docker.com/_/mysql
לתשומת לבכם, הקמת בסיס הנתונים תתבסס על הרצת פקודת DOCKER – בדומה לאופן שבו הקמנו בסיס
נתונים אחר של POSTRESQL – כך שעל מכונת ה-LINUX שלכם ירוץ CONTAINER DOCKER של
.MYSQL
● עליכם לוודא כי הגרסא של בסיס הנתונים של MYSQL היא הגרסה העדכנית ביותר של IMAGE
של DOCKER שזמין להורדה מ-HUB DOCKER
● עליכם לוודא כי בסיס הנתונים חושף למכונת הלינוקס שעליה הוא רץ את port מספר 3306
● עליכם לוודא כי הסיסמא של משתמשת העל )ROOT )של בסיס הנתונים היא: pw-secret-my
לתשומת לב: נפחו של ה-IMAGE של MYSQL הוא כ-MB650
ב. יש לוודא כי בסיס הנתונים עובד בצורה תקינה.
לשם כך, עליכם להשתמש בפרויקט לדוגמא שעבדנו אתו בכתה, וניתן להקים אותו בסביבת ה-LINUX שלכם
על ידי שכפול מאגר GIT.
ב.1 עליכם לשכפל את מאגר הפרויקט באמצעות הפקודה הבאה:
git clone
https://Cloud-Afeka@bitbucket.org/cloudengcoordafeka/demousersservicewithrdb.git
הפקודה תשכפל למחשב שלכם את הפרויקט ותיצור עבורו תיקיה ששמה: demousersservicewithrdb
ב.2 כעת, עליכם לוודא שניתן להריץ את קובץ ה-SCRIPT ששמו gradlew
בדקו האם ניתן להריץ את הקובץ באמצעות פקודת ה-LINUX שמציגה את פרטי הקבצים בתיקית הפרויקט.
במידת הצורך הוסיפו הרשאות הרצה לקובץ, כפי שלמדנו בקורס.
עמוד 1 מתוך 8
 
 
דף 2 מתוך 8
פרויקט מסכם בקורס כלי פיתוח: הקמת WIKI של מושגי הקורס - סמסטר א תשפד מרצה: איל איזנשטיין
ב.3 הריצו את הפרויקט ששכפלתם באמצעות הפקודה:
./gradlew bootRun
ב.3A. שימו לב כי פרויקט זה דורש התקנה של בסיס נתונים אחר על המחשב שלכם: POSGRESQL.
כדי להתקין את POSGRESQL, ניתן להשתמש ב-DOCKER שלו.
ניתן לעשות זאת, כפי שעשינו זאת בשיעורים קודמים בקורס, באמצעות פקודת ה-DOCKER הבאה:
docker run --name some-postgres -e POSTGRES_PASSWORD=mysecretpassword
-p5432:5432 -d postgres:latest
לתשומת לב: נפחו של ה-IMAGE של POSGRESQL הוא כ-MB450
ב.4 כעת, לאחר שהפרויקט שהורדתם מ-git רץ, פתחו את הדפדפן שלכם ב-URL הבא, שכולל יישום WEB
שיעזור לכם לבדוק שבסיס הנתונים של MYSQL מותקן ועובד כהלכה:
http://localhost:8086/h2-console
בטופס שיפתח לכם בדפדפן מלאו את הפרטים הבאים:
Saved settings: Generic MySQL
JDBC URL: jdbc:mysql://localhost:3306/mysql
User Name: root
Password: my-secret-pw
כעת, יש ללחוץ על הכפתור Connect כדי להתחבר לבסיס הנתונים.
כדי לבדוק שניתן לתחקר את טבלאות בסיס הנתונים, עליך לבחור באחת הטבלאות שמופיעה ברשימה
משמאל וללחוץ עליה.
למשל, עליך לבחור בטבלה db וללחוץ עליה. בחלונית במרכז הטופס תופיע הפקודה להצגת תוכן הטבלה:
SELECT * FROM db
עליך ללחוץ על כפתור Run כדי להריץ את הפקודה ולראות רשימה של בסיסי נתונים שהוקמו עם ההתקנה.
אם לא הופיעו לך הודעות שגיאה הרי שבסיס הנתונים הותקן בהצלחה.
ג. לסיום אפשר לסגור את הדפדפן.
כעת כדאי להפסיק את היישום שהרצת עם gradle על ידי לחיצה על C+CTRL בחלונית הקונסולה.
אם הרצת DOCKER של POSTRESQL, עליך להפסיק אותו:
● עליך לבדוק אילו CONTAINERS של DOCKER רצים באמצעות הפקודה:
docker ps
עמוד 2 מתוך 8
 
דף 3 מתוך 8
פרויקט מסכם בקורס כלי פיתוח: הקמת WIKI של מושגי הקורס - סמסטר א תשפד מרצה: איל איזנשטיין
● הפסקת ריצה של CONTAINER יש לבצע כך:
docker stop <POSTRESQL_DOCKER_CONTAINER_ID>
לתשומת לבך: ID_CONTAINER_DOCKER_POSTRESQL הוא ה-ID CONTAINER שיופיע לך
ברשימת ה-CONTAINERS של DOCKER.
.2 עליכם להתקין את יישום mediawiki באמצעות DOCKER.
א. יש להעזר בהוראות ההקמה של mediawiki, יישום בשפת PHP שהוא גם התשתית ל-WIKIPEDIA,
באמצעות DOCKER. ניתן להעזר בהוראות בדף הרשמי של היישום ב-HUB DOCKER:
https://hub.docker.com/_/mediawiki
חפשו בדף ההנחיות בדף הרשמי של היישום ב-HUB DOCKER הוראות להרצת ה-IMAGE.
לתשומת לב: הריצו את ה-DOCKER של mediawiki כך שיחשוף על מכונת ה-LINUX שלכם port שמספרו
,8080 באמצעות הוספה לפקודת ההרצה של DOCKER את הפרמטר:
-p8080:80
לתשומת לב: נפחו של ה-IMAGE של mediawiki הוא קצת למעלה מ-GB1
.3 קונפיגורציה של mediawiki
א. בדיקת ריצה של DOCKERS
ראשית, כדאי לבדוק שה-DOCKER של mediawiki אכן רץ.
הפעילו פקודה של DOCKER שמציגה את כל ה-CONTAINERS שרצים וודאו שאתם רואים שם גם את
ה-DOCKER של mediawiki וגם את זה של MYSQL.
ב. קונפיגורציה של mediawiki באמצעות דפדפן.
עליך לפתוח את הדפדפן ל מכונת ה-LINUX בקישור הבא, שיתחבר להתקנה של mediawiki:
http://localhost:8080
לתשומת לב: יתכן ולאורך הקורס תשתמשו באותו אתר mediawiki שאתם מקימים כעת. כדי למנוע תקלות
שנובעות משינוי כתובות ה-IP במכונות שאתן אתם עובדים, מומלץ להגדיר בקישור את ה-HOSTNAME
ששמו localhost, אם כי זה עלול להגביל אתכם מלגשת לשרת ממחשבים אחרים.
אם תתחברו לקישור עם ה-HOSTNAME האמיתי של מכונת ה-LINUX או עם כתובת ה-IP שלו, תוכלו
להתחבר אליו גם ממחשבים אחרים. אולם אז, במידה ואתם עובדים עם מכונות וירטואליות, כמו המכונות
הוירטואליות של אפקה, יתכן ותאלצו להקים מחדש בכל פעם את שרת ה-WIKI.
לבירור כתובת ה-IP או ה-HOSTNAME של מכונת ה-LINUX שלכם, תוכלו לחפש פקודות LINUX נפוצות
שעושות זאת.
כעת, אמורה להופיע בדפדפן הודעה על שלא מוגדר לכם קובץ קונפיגורציה חיוני בשם php.LocalSettings
בתחתית הדף, יופיע לכם קישור שיאפשר לכם ליצור קובץ זה אחרי שתגדירו הגדרות קונפיגורציה.
לחצו על הקישור.
עמוד 3 מתוך 8
דף 4 מתוך 8
פרויקט מסכם בקורס כלי פיתוח: הקמת WIKI של מושגי הקורס - סמסטר א תשפד מרצה: איל איזנשטיין
ב.1 הגדרות כלליות
● עליכם להגדיר את mediawiki לעבוד באנגלית.
● עליכם לאשר את תנאי השימוש ב-mediawiki
● בדף החיבור לבסיס הנתונים, עליכם להגדיר את הקונפיגורציה של MYSQL, לפי ההנחות שבהמשך
ב.2 קונפיגורציה של היישום לעבודה עם MYSQL
● בשדה hos Database יש לפעול לפי ההנחיות בטופס.
○ לתשומת לב: יש להגדיר כאן את כתובת ה-IP של מכונת ה-LINUX שאתם רצים עליה
● בשדה name Database השאירו את ברירת המחדל: wiki_my
● בשדה prefix table Database שמגדיר את התחילית של שמות כל טבלאות בסיס הנתונים של
היישום, הגדירו:
afekawiki_
:MYSQL הגדירו את שם המשתמש בעל הרשאות הניהול של username Database בשדה
root
● בשדה password Database הגדירו את הסיסמא שהקלדתם בפקודת ההרצה של ה-DOCKER
של MYSQL:
my-secret-pw
אם בהמשך ההתקנה, תתבקשו להגדיר חשבון בבסיס הנתונים לשם גישה ל-WEB באמצעות הגדרת
Use the same account as for הבחירה תיבת את סמנו Database account for web access
installation
ב.3 קונפיגורציה של יישום ה-WIKI שלכם
:הגדירוName of wiki בשדה●
afekawiki
Same as the wiki name :באפשרות בחרו ,PROJECT NAMESPACE להגדיר תתבקשו אם●
בהגדרות account Administrator, עליכם להגדיר חשבון משתמשים עם הרשאות לנהול התכנים שלכם.
● הגדירו את שם המשתמש להיות:
demoadmin
● הגדירו את הסיסמא להיות:
secretpass
● בשדה address Email הגדירו את כתובת הדואל שלכם באפקה
ב.4 כשתתבקשו להגדיר את אופי זכויות התכנים – profile rights User עליכם לבחור באפשרות:
Open wiki
עמוד 4 מתוך 8
דף 5 מתוך 8
פרויקט מסכם בקורס כלי פיתוח: הקמת WIKI של מושגי הקורס - סמסטר א תשפד מרצה: איל איזנשטיין
● בשדה license and Copyright בחרו באפשרות:
GNU Free Documentation License 1.3 or later
● במקטע settings Email ודאו שתיבת הבחירה הבאה לא מסומנת:
Enable outbound email
● במקטע Skins בחרו ב-Vector וסמנו אותו להיות ברירת המחדל )default as skin this Use)
○ אפשר להסיר את הבחירה ביתר האפשרויות של Skins
● במקטע pages Special בחרו באפשרויות הבאות:
CiteThisPage ○
interwiki ○
● במקטע Editors בחרו באפשרויות הבאות )מומלץ לעשות זאת בסדר זה, כי יש תלויות בין
ה-EDITORS השונים(:
WikiEditor ○
CodeEditor ○
Visual Editor ○
● במקטע hooks Parser בחרו באפשרויות הבאות:
CategoryTree ○
ImageMap ○
Math ○
Poem ○
● במקטע handlers Media בחרו באפשרות:
PdfHandler ○
● במקטע Other בחרו באפשרות:
Gadgets ○
:באפשרויות בחרו Images and file uploads במקטע●
Enable file uploads ○
○ בשדה files deleted for Directory הגדירו את התיקיה:
/deleted
Enalbe instant commons את אפשרו○
:באפשרות בחרו Settings for object caching במקטע●
No caching ○
המשיכו לדף הבא שמציג אפשרות להתקנת הקונפיגורציה שהגדרתם ולחצו על הכפתור Continue להתקנת
ההגדרות שלכם.
עליכם לוודא כי מצוין לכם שהתקנת ההגדרות שלכם הצליחה.
בדף Complete יצוין לכם כי הגדרות הקונפיגורציה שלכם מופיעות בקובץ קונפיגורציה ששמו:
LocalSettins.php
במידה וקובץ זה לא ירד לתיקיית ההורדות של הדפדפן, לחצו על הקישור שיוריד אותו לתיקית ההורדות.
עמוד 5 מתוך 8
 
דף 6 מתוך 8
פרויקט מסכם בקורס כלי פיתוח: הקמת WIKI של מושגי הקורס - סמסטר א תשפד מרצה: איל איזנשטיין
גבו את הקובץ הזה:
● למשל, תוכלו לשמור אותו ב-REPOSITORY שלכם ב-BITBUCKET
● למשל, תוכלו לשלוח אותו לעצמכם בדואל
.4 העתקת הקונפיגורציה של mediawiki ל-DOCKER
פתחו TERMINAL ובצעו את הפעולות הבאות:
● הריצו פקודה של DOCKER שלמדנו בקורס כדי לברר מה ה-ID CONTAINER של ה-DOCKER
של mediawiki
גשו לתיקיה אליה הורדתם את הקובץ php.LocalSettins והריצו את הפקודה הבאה – שימו לב כי עליכם
לכתוב את ה-ID CONTAINER שביררתם במקום >>ID CONTAINER>>
docker cp LocalSettings.php <<CONTAINER ID>>:/var/www/html/LocalSettings.php
לתשומת לבכם: פקודה זו תעתיק את הקובץ מתיקיית ה-LINUX שלכם לתיקיה ששמה html/www/var
שמוגדרת במערכת הקבצים ב-DOCKER של mediawiki
.5 הרצה של mediawiki ויצירת תכנים ראשונית
גלשו לשרת של mediawiki שהקמתם:
http://localhost:8080/index.php/Main_Page
ודאו שאתם אכן רואים את הדף הראשי של האתר שהקמתם.
5א. בצעו LOGIN לאתר, והוסיפו תכנים
● לחצו על הקישור in Log בצד ימין למעלה של הדף
● הזינו את שם המשתמש והסיסמא שהגדרתם בשלב ההקמה של האתר:
○ שם משתמש: demoadmin
○ סיסמא: secretpass
● כדי לוודא שהפעולה הצליחה – שימו לב האם שם המשתמש demoadmin מופיע בראש הדף,
ליד הקישור talk
● כדי ליצור ערך wiki אפשר לחפש ערך בתיבת החיפוש, למשל את הערך Linux ואם לא הוגדר ערך
כזה, באפשרותכם ליצור אותו על ידי לחיצה על הקישור עם שם הערך בהודעה שתופיע לכם:
Create the page ”Linux” on this wiki!
● במידה ופעלתם לפי ההנחיות, יוצע לכם לערוך את הערך, אחרי לחיצה על הקישור באמצעות עורך
טקסט מתקדם
● ערכו את הערך. תוכלו להעזר במילון המונחים של הקורס בהזנת המידע
● צרו בטקסט שלכם קישורים לערך אחר אחד לפחות, שתוסיפו בהמשך ל-WIKI שלכם
○ בעורך הטקסט תמצאו אפשרות ליצירת קישורים בסרגל הכלים שמעל לחלון הטקסט שאתם
עורכים
○ הקפידו שהקישור שאתם יוצרים יהיה פנימי – כלומר כזה שמוגדר ב-afekawiki
■ להזכירכם, afekawiki הוא שם ה-WIKI שלכם, כפי שהגדרתם בקונפיגורציה
Name of wiki בשדה
עמוד 6 מתוך 8
דף 7 מתוך 8
פרויקט מסכם בקורס כלי פיתוח: הקמת WIKI של מושגי הקורס - סמסטר א תשפד מרצה: איל איזנשטיין
○ באפשרותכם להוסיף ל-WIKI תמונות, על ידי לחיצה על כפתור Insert בסרגל הכלים,
בחירה באפשרות media and Images ובחלון שיפתח, להקליד טקסט לחיפוש תמונה
○ אחרי שבחרתם בתמונה הרצויה לכם, תנו לה כותרת
● שמרו את ה-wiki שיצרתם
Log out בצעו●
● חפשו שוב בחלונית החיפוש את הערך וודאו שה-wiki שיצרתם מוצג לכם בצורה ברורה
.6 החלפת הלוגו של האתר
● צרו קובץ תמונה בעזרת כל יישום שתרצו לפי המפרט הבא:
○ סוג הקובץ: קובץ jpg
○ מימדי התמונה בפיקסלים: 135X135
○ שם הקובץ: jpg.myWikiLogo
● העתיקו את הקובץ ל-DOCKER של ה-WIKI שלכם
○ באמצעות ה-terminal של Linux גשו לתיקיה שבה מיקמתם את הקובץ
○ הריצו פקודה של DOCKER שלמדנו בקורס כדי לברר מה ה-ID CONTAINER של
ה-DOCKER של mediawiki
● הפעילו את הפקודה הבאה, להעתקת תכנים ממכונת ה-LINUX ל-DOCKER של mediawiki -
שימו לב לכתוב את ה-ID CONTAINER שביררתםבמקום >>ID CONTAINER>>
docker cp myWikiLogo.jpg <<CONTAINER
ID>>:/var/www/html/images/myWikiLogo.jpg
● השתמשו בפקודה שכבר השתמשתם בה, כדי להעתיק את קובץ הקונפיגורציה php.LocalSettins
מה-DOCKER לתיקיה שלכם במכונת ה-LINUX
● בשלב זה, מומלץ לגבות את הקובץ, למקרה שהוא ישתבש לכם בעריכה
● אחרי שגיביתם את הקובץ php.LocalSettins, פתחו אותו באמצעות עורך טקסט, למשל
בעזרת nano
● חפשו בקובץ את הגדרת הלוגו של ה-WIKI שלכם תחת:
$wgLogos
● החליפו את מיקום קובץ הלוגו בהפניות לקובץ התמונה שערכתם והעתקתם לשרת:
/images/myWikiLogo.jpg
○ שימו לב כי את מיקום הקובץ יש לרשום באופן יחסי לתיקיה:
$wgResourceBasePath
○ שימו לב עוד כי בקובץ הקונפיגורציה יש שתי הפניות לקבצים שעליכם להחליף
● העתיקו את הקובץ שערכתם ששמו php.LocalSettings בחזרה ל-DOCKER עם פקודה דומה לזו
שבאמצעותה כבר העתקתם קובץ זה, אחרי שיצרתם אותו כשהגדרתם את הקונפיגורציה של
ה-WIKI שלכם.
● שימו לב כי יתכן ועליכם לעשות restart לשרת ה-WIKI כדי שלשינוי יהיה תוקף
○ לשם כך, הזכרו בפקודות שלמדנו בקורס, כדי לאתחל DOCKER שרץ
● גלשו שוב לאתר וודאו שהלוגו הוחלף. מומלץ למחוק את ה-CACHE של הדפדפן לפני הבדיקה
● מומלץ לשמור ב-REPOSITORY שלכם ב-BITBUCKET את קובץ הלוגו ואת הקובץ
LocalSettings.php
עמוד 7 מתוך 8
דף 8 מתוך 8
פרויקט מסכם בקורס כלי פיתוח: הקמת WIKI של מושגי הקורס - סמסטר א תשפד מרצה: איל איזנשטיין
.7 גיבוי בסיס הנתונים
7א. התקנת יישום גיבוי: mysqldump
הפעילו את הפקודות הבאות לביצוע ההתקנה:
sudo apt update
sudo apt install mysql-client-core-8.0
7ב. גיבוי בסיס הנתונים
הפעילו את הפקודה הבאה לביצוע הגיבוי:
mysqldump -h 127.0.0.1 -u root -pmy-secret-pw --default-character-set=binary my_wiki
| gzip > my-wiki.backup.sql.gz
מומלץ לשמור את קובץ הגיבוי gz.sql.backup.wiki-my ב-REPOSITORY שלכם ב-BITBUCKET
7ג. שחזור גיבוי בסיס הנתונים
ליצירת בסיס נתונים בשם wiki_my על CONTAINER DOCKER נקי של MYSQL:
mysqladmin -h 127.0.0.1 -u root -pmy-secret-pw create my_wiki
פרישת נתוני בסיס הנתונים המגובים ל-DOCKER של MYSQL:
gunzip < my-wiki.backup.sql.gz | mysql -h 127.0.0.1 -u root -pmy-secret-pw my_wiki
כעת כדאי לעשות restart לשרת ה-WIKI כדי שלשינוי יהיה תוקף.
ד. שחזור שרת mediawiki
● יש למחוק את ה-DOCKER של mediawiki
● יש להריץ מחדש DOCKER של mediawiki
● יש להשתמש בגיבוי של קובץ הקונפיגורציה php.LocalSettings ולשנות בו את כתובת
ה-IP של בסיס הנתונים, או כתובת ה-IP של מכונת ה-LINUX, שמוגדרת באמצעות עדכון השורה
שכוללת את המשתנה:
$wgDBserver
● יש להעתיק ל-DOCKER החדש של mediawiki, את קובץ הקונפיגורציה php.LocalSettings
● יש להעתיק ל-DOCKER החדש של mediawiki, את קובץ התמונה של הלוגו שיצרתם
● יש לבצע אתחול )restart )של ה-DOCKER של mediawiki
● מומלץ לבדוק באמצעות הדפדפן שהשחזור הצליח